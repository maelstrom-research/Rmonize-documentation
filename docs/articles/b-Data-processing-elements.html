<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data Processing Elements • Rmonize</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Data Processing Elements">
<meta property="og:description" content="Rmonize">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rmonize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1.0003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a-Glossary-and-templates.html">Glossary and templates</a>
    </li>
    <li>
      <a href="../articles/b-Data-processing-elements.html">Data Processing Elements</a>
    </li>
    <li>
      <a href="../articles/c-Example-with-Rmonize_DEMO.html">Example with Rmonize_DEMO</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/maelstrom-research/Rmonize/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="b-Data-processing-elements_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="b-Data-processing-elements_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="b-Data-processing-elements_files/datatables-binding-0.30/datatables.js"></script><link href="b-Data-processing-elements_files/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="b-Data-processing-elements_files/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="b-Data-processing-elements_files/dt-core-1.13.4/js/jquery.dataTables.min.js"></script><link href="b-Data-processing-elements_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="b-Data-processing-elements_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="b-Data-processing-elements_files/jszip-1.13.4/jszip.min.js"></script><link href="b-Data-processing-elements_files/dt-ext-buttons-1.13.4/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="b-Data-processing-elements_files/dt-ext-buttons-1.13.4/js/dataTables.buttons.min.js"></script><script src="b-Data-processing-elements_files/dt-ext-buttons-1.13.4/js/buttons.html5.min.js"></script><script src="b-Data-processing-elements_files/dt-ext-buttons-1.13.4/js/buttons.colVis.min.js"></script><script src="b-Data-processing-elements_files/dt-ext-buttons-1.13.4/js/buttons.print.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Data Processing Elements</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/maelstrom-research/Rmonize/blob/HEAD/vignettes/b-Data-processing-elements.Rmd" class="external-link"><code>vignettes/b-Data-processing-elements.Rmd</code></a></small>
      <div class="hidden name"><code>b-Data-processing-elements.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="what-is-the-data-processing-elements">What is the Data Processing Elements ?<a class="anchor" aria-label="anchor" href="#what-is-the-data-processing-elements"></a>
</h2>
<p>The Data Processing Elements (<strong>DPE</strong>) is a table that
defines and documents information about the processing used to generate
harmonized datasets and is typically prepared in an Excel spreadsheet.
Each row indicates if an input dataset can generate a DataSchema
variable, and if so, how input variables are processed to generate a
harmonized variable as defined in the DataSchema. This page explains the
basic methods to fill out the DPEs in order to be used correctly by
Rmonize functions.</p>
</div>
<div class="section level2">
<h2 id="general-structure-of-the-dpe">General structure of the DPE<a class="anchor" aria-label="anchor" href="#general-structure-of-the-dpe"></a>
</h2>
<p>The DPE is an typically an Excel file that you open locally in your
computer and that you can fill one row after the other to generate the
rules of harmonization. It contains at least 5 mandatory columns, plus
one additional for your documentation. The process cannot work if one of
these columns are not present.</p>
<div>
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-3d13354fd0a5ba0091d4" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-3d13354fd0a5ba0091d4">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<code><b>dataschema_variable<\/b><\/code>","<code><b>input_dataset<\/b><\/code>","<code><b>input_variables<\/b><\/code>","<code><b>Mlstr_harmo::rule_category<\/b><\/code>","<code><b>Mlstr_harmo::algorithm<\/b><\/code>"],["Variable defined in the DataSchema","Input dataset where the <br>\n                                                 input variable(s) is/are taken from","Input variable(s) (name(s) of the column in the dataset)","Rule category","Algorithm associated to the rule category"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>column name<\/th>\n      <th>definition<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<p><a href="#summary">return to summary</a></p>
</div>
<div class="section level2">
<h2 id="harmonization-rules">Harmonization rules<a class="anchor" aria-label="anchor" href="#harmonization-rules"></a>
</h2>
<!-- Harmonization Rules Navigation -->
<div class="row">
<!-- Nav Buttons -->
<div class="col-md-3">
<ul class="nav nav-pills nav-stacked" role="tablist">
<li class="active">
<a href="#id-creation" role="tab" data-toggle="tab"> id_creation </a>
</li>
<li>
<a href="#direct-mapping" role="tab" data-toggle="tab"> direct_mapping
</a>
</li>
<li>
<a href="#recode" role="tab" data-toggle="tab"> recode </a>
</li>
<li>
<a href="#case-when" role="tab" data-toggle="tab"> case_when </a>
</li>
<li>
<a href="#paste" role="tab" data-toggle="tab"> paste </a>
</li>
<li>
<a href="#operation" role="tab" data-toggle="tab"> operation </a>
</li>
<li>
<a href="#other" role="tab" data-toggle="tab"> other </a>
</li>
<li>
<a href="#impossible-undertermined" role="tab" data-toggle="tab">
impossible<br> undertermined<br> __BLANK__ </a>
</li>
</ul>
</div>
<div class="col-md-9">
<!-- Nav Contents -->
<div class="tab-content">
<!-- ID Creation -->
<div id="id-creation" class="tab-pane fade active in">
<p><strong>id_creation</strong> is mandatory and the first rule that
initiates the harmonization process. This rule allows the user to
provide the column used as a reference per observation (row).</p>
<div style="width: 70%; margin: 0 auto; display: flex; justify-content: center;">
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-eb56c7936d6556c6fc3b" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-eb56c7936d6556c6fc3b">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<b>dataschema_variable<\/b>","<b>input_dataset<\/b>","<b>input_variables<\/b>","<b>Mlstr_harmo::rule_category<\/b>","<b>Mlstr_harmo::algorithm<\/b>"],["<code> harmonized_id <\/code>","<code> input_dataset <\/code>","<code> input_id <\/code>","<code><b>id_creation<\/b><\/code>","<code> <b>id_creation<\/b> <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<p><br></p>
<p>Notes:</p>
<ul>
<li><p>Usually, the harmonized variable is a standardized identifier
generated from the input identifier.</p></li>
<li><p>If the dataset does not have any identifier column, the user can
create <em>before harmonization</em> an index and provide this index as
the variable to use.</p></li>
</ul>
</div>
<!-- Direct Mapping -->
<div id="direct-mapping" class="tab-pane fade">
<p>The harmonized variable is generated by replicating one input
variable.</p>
<div style="width: 70%; margin: 0 auto; display: flex; justify-content: center;">
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-7275b876365c27771874" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-7275b876365c27771874">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<b>dataschema_variable<\/b>","<b>input_dataset<\/b>","<b>input_variables<\/b>","<b>Mlstr_harmo::rule_category<\/b>","<b>Mlstr_harmo::algorithm<\/b>"],["<code> output_var <\/code>","<code> input_dataset <\/code>","<code> input_var <\/code>","<code> <b>direct_mapping<\/b> <\/code>","<code> <b>direct_mapping<\/b> <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<p><br></p>
<p>Note:</p>
<ul>
<li>One and only one variable can be replicated at a time.</li>
</ul>
</div>
<!-- Recode -->
<div id="recode" class="tab-pane fade">
<p>The harmonized variable is generated by recoding values from one
input variable.</p>
<div style="width: 70%; margin: 0 auto; display: flex; justify-content: center;">
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-375821ba74dab6a6a635" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-375821ba74dab6a6a635">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<b>dataschema_variable<\/b>","<b>input_dataset<\/b>","<b>input_variables<\/b>","<b>Mlstr_harmo::rule_category<\/b>","<b>Mlstr_harmo::algorithm<\/b>"],["<code> output_var <\/code>","<code> input_dataset <\/code>","<code> input_var <\/code>","<code> <b>recode<\/b> <\/code>","<code> <b>recode(<\/b>\n  \"YES\" = 1 ;\n  \"NO\"  = 0 ;\n  ELSE  = NA<b>) <\/b> <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<p><br></p>
<p>Notes:</p>
<ul>
<li><p>One and only one variable can be recoded at a time.</p></li>
<li><p>The variable to be recoded must be (partially at the very least)
a categorical variable. To recode a continuous variable (to create
brackets for example.), use <strong>case_when</strong> instead.</p></li>
<li><p>If all categories are recoded to the same categories (recode(1 =
1 ; 2 = 2)), Prefer <strong>direct_mapping</strong> instead.</p></li>
<li><p>Separate each value/code with an equal sign
<strong>=</strong></p></li>
<li><p>Separate each elements with a semi-colon <strong>;</strong>
.</p></li>
<li><p>Use <strong>ELSE = NA</strong> to attribute NA to all of the
other values.</p></li>
</ul>
<p>If an equal sign already exists in the data, use <strong>_=</strong>
to escape them. Equally, if a semi-colon already exists in the data, use
<strong>_;</strong> to escape them.</p>
<pre><code>recode(
"banana ; apple"  = "fruits"    _;
"salad  ; potatoe" = "veggies"  _;
"bread  ; pasta"   = "carbs"        )

recode(
"1000 (='high')  _= 3  ;
" 500 (='mid')   _= 2  ;
" 200 (='low')   _= 1     )
</code></pre>
<p>The values can be gathered using R syntax to recode multiple
numerical values.</p>
<pre><code>recode(
0            = "low"   ;
c(1:10)      = "mid"   ;
c(-7, -99)   = NA    )
</code></pre>
<p>If the recoding requires more complex codification, use
<strong>case_when</strong> or <strong>other</strong> instead.</p>
</div>
<!-- Case When -->
<div id="case-when" class="tab-pane fade">
<p>The harmonized variable is generated from one or more if-else
conditions, using one or more input variables.</p>
<div style="width: 70%; margin: 0 auto; display: flex; justify-content: center;">
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-df65940a7ecd2380b816" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-df65940a7ecd2380b816">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<b>dataschema_variable<\/b>","<b>input_dataset<\/b>","<b>input_variables<\/b>","<b>Mlstr_harmo::rule_category<\/b>","<b>Mlstr_harmo::algorithm<\/b>"],["<code> output_var <\/code>","<code> input_dataset <\/code>","<code> input_var_x ; input_var_y <\/code>","<code> <b>case_when<\/b> <\/code>","<code> <b>case_when(<\/b>\n  var_x == 1 ~ var_z ;\n  ELSE       ~ NA<b>)<\/b> <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<p><br></p>
<p>Notes:</p>
<ul>
<li><p>Multiple variables can be used to combine their values using
case_when. Separate each of them in <strong>input_variables</strong> by
a semi-colon <strong>;</strong></p></li>
<li><p>If only one variable is used, and is (or seems) a categorical
variable, use <strong>recode</strong> or <strong>direct_mapping</strong>
instead.</p></li>
<li><p>Each statement (“if … equals, greater, is not, …”) can be use in
this function. Separate the statement/code with a tilde
<strong>~</strong></p></li>
<li><p>Separate each elements with a semi-colon <strong>;</strong>
.</p></li>
<li><p>Use <strong>ELSE ~ NA</strong> to attribute NA to all of the
other values.</p></li>
</ul>
<p><strong>case_when</strong> is sensitive to the data type. Each code
generated with the statement must have the same data type, including the
NA.</p>
<pre><code>case_when(
var_x == 1                 ~ 1L  
var_x != 0 &amp; !is.na(var_y) ~ 0L  
ELSE                       ~ NA_integer_  )

case_when(
var_x == 1                 ~ "1"  
var_x != 0 &amp; !is.na(var_y) ~ "0"  
ELSE                       ~ NA_character_)
</code></pre>
<p>If the statement requires more complex codification, use
<strong>other</strong> instead.</p>
</div>
<!-- Paste -->
<div id="paste" class="tab-pane fade">
<p>The harmonized variable is generated by setting the same value for
all observation, not taken from a input variable.</p>
<div style="width: 70%; margin: 0 auto; display: flex; justify-content: center;">
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-57f3aa6da8202fbd3e80" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-57f3aa6da8202fbd3e80">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<b>dataschema_variable<\/b>","<b>input_dataset<\/b>","<b>input_variables<\/b>","<b>Mlstr_harmo::rule_category<\/b>","<b>Mlstr_harmo::algorithm<\/b>"],["<code> output_var <\/code>","<code> input_dataset <\/code>","<code> <b>__BLANK__<\/b> <\/code>","<code> <b>paste<\/b> <\/code>","<code> \"Hello word\" <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<p><br></p>
<p>Notes:</p>
<ul>
<li><p>This function does not require any variable. The user must
provide <strong>__BLANK__</strong> as a placeholder.</p></li>
<li><p>Usually, the harmonized variable is a standardized identifier for
the whole dossier when comes the time to aggregate the harmonized
datasets into a pooled harmonized dataset.</p></li>
</ul>
</div>
<!-- Operation -->
<div id="operation" class="tab-pane fade">
<p>The harmonized variable is generated by applying an operation to one
or more input variables.</p>
<div style="width: 70%; margin: 0 auto; display: flex; justify-content: center;">
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-fb97ac75422d53a74fcd" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-fb97ac75422d53a74fcd">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<b>dataschema_variable<\/b>","<b>input_dataset<\/b>","<b>input_variables<\/b>","<b>Mlstr_harmo::rule_category<\/b>","<b>Mlstr_harmo::algorithm<\/b>"],["<code> output_var <\/code>","<code> input_dataset <\/code>","<code> input_var <\/code>","<code> <b>operation<\/b> <\/code>","<code> <em># simple R code here such as :<\/em><\/b>\n  (<b>mean(<\/b>input_var<b>)<\/b> - input_var<b>)<\/b> / <b>stats::sd(<\/b>input_var<b>)<\/b> <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<p><br></p>
<p>Notes:</p>
<ul>
<li><p>Multiple variables can be used to combine their values using
case_when. Separate each of them in <strong>input_variables</strong> by
a semi-colon <strong>;</strong></p></li>
<li><p>If the operation (or seems) is simple, prefer
<strong>case_when</strong>, <strong>recode</strong> or
<strong>direct_mapping</strong> instead.</p></li>
<li><p>The user must have the libraries present on their machine (and
loaded) to function with the call of them in the Case Whenscript. To
specify the library calling, use double two-point <strong>::</strong> in
the formula.</p></li>
</ul>
<pre><code><span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">var_x</span><span class="op">)</span></span></code></pre>
<ul>
<li>If the operation is requires more complex codification, use
<strong>other</strong> instead.</li>
</ul>
</div>
<!-- Other -->
<div id="other" class="tab-pane fade">
<p>The harmonized variable is generated from a non-standard or complex
processing rule, not covered by other rule categories.</p>
<div style="width: 70%; margin: 0 auto; display: flex; justify-content: center;">
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-43e1203fcd8b5f0f3f28" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-43e1203fcd8b5f0f3f28">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<b>dataschema_variable<\/b>","<b>input_dataset<\/b>","<b>input_variables<\/b>","<b>Mlstr_harmo::rule_category<\/b>","<b>Mlstr_harmo::algorithm<\/b>"],["<code> output_var <\/code>","<code> input_dataset <\/code>","<code> <b>__BLANK__<\/b> <\/code>","<code> <b>other<\/b> <\/code>","<code> # place complex R code here... <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<p><br></p>
<p>Note:</p>
<ul>
<li>This feature is equivalent to launch a local code/function in a R
script.</li>
</ul>
<p>If assignment is needed to modify environment of the user, use double
assignation <strong>&lt;&lt;-</strong> to place the result in the user
environment. Carefully make sure you control your environment when using
the <strong>other</strong> function.</p>
<pre><code><span><span class="va">my_harmo_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span> <span class="op">+</span> <span class="va">...</span> <span class="co"># complex lines of code</span></span>
<span></span>
<span><span class="co"># double assignation to modify the environment.</span></span>
<span><span class="va">harmonized_dossier</span><span class="op">$</span><span class="va">DATASET</span><span class="op">$</span><span class="va">variable_F</span> <span class="op">&lt;&lt;-</span> <span class="va">my_harmo_var</span></span></code></pre>
<p><strong>other</strong> function can be used to source a code from a
different script where complex harmonization processes are written.</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"my_file.R"</span><span class="op">)</span></span></code></pre>
</div>
<!-- Impossible Undertermined __BLANK__ -->
<div id="impossible-undertermined" class="tab-pane fade">
<p>These additional features allow the user to handle specific cases.
This ensure that the line is completed and there is no missing argument
in the function to perform.</p>
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-16798489449353555408" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-16798489449353555408">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<code> output_var <\/code>","<code> output_var <\/code>","<code> output_var <\/code>","<code> output_var <\/code>"],["<code> input_dataset <\/code>","<code> input_dataset <\/code>","<code> input_dataset <\/code>","<code> input_dataset <\/code>"],["<code> <b>__BLANK__<\/b> <\/code>","<code> <b>__BLANK__<\/b> <\/code>","<code> <b>impossible<\/b> <\/code>","<code> <b>undetermined<\/b> <\/code>"],["<code> <b>paste<\/b> <\/code>","<code> <b>other<\/b> <\/code>","<code> <b>impossible<\/b> <\/code>","<code> <b>undetermined<\/b> <\/code>"],["<code> \"Hello word\" <\/code>","<code> # place complex R code here... <\/code>","<code> <b>impossible<\/b> <\/code>","<code> <b>undetermined<\/b> <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th><b>dataschema_variable<\/b><\/th>\n      <th><b>input_dataset<\/b><\/th>\n      <th><b>input_variables<\/b><\/th>\n      <th><b>Mlstr_harmo::rule_category<\/b><\/th>\n      <th><b>Mlstr_harmo::algorithm<\/b><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":4,"columnDefs":[{"className":"dt-head-left","targets":"_all"}],"headerCallback":"function(thead) { $(thead).css('font-size', '0.7em');}","ordering":false,"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[4,10,25,50,100]}},"evals":["options.headerCallback"],"jsHooks":[]}</script><p><br></p>
<p>Notes:</p>
<ul>
<li><p><em>__BLANK__</em> : If no variable is needed to generate the
harmonized variable (for example using the rule category
<strong>paste</strong> or <strong>other</strong>)</p></li>
<li><p><em>impossible</em> : If the project of research does not collect
DataSchema variable or cannot be used to generate DataSchema variable or
is unknown.</p></li>
<li><p><em>undetermined</em> : If the user needs further investigation
to harmonize, or future information to be completed, they can use this
feature without being blocked in the process.</p></li>
</ul>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="examples-of-rule-categories">Examples of Rule Categories<a class="anchor" aria-label="anchor" href="#examples-of-rule-categories"></a>
</h3>
<div>
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-9e9d166daf0835ad3d29" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-9e9d166daf0835ad3d29">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["<code> harmonized_id <\/code>","<code> output_var <\/code>","<code> output_var <\/code>","<code> output_var <\/code>","<code> output_var <\/code>","<code> output_var <\/code>","<code> output_var <\/code>","<code> output_var <\/code>","<code> output_var <\/code>"],["<code> input_dataset <\/code>","<code> input_dataset <\/code>","<code> input_dataset <\/code>","<code> input_dataset <\/code>","<code> input_dataset <\/code>","<code> input_dataset <\/code>","<code> input_dataset <\/code>","<code> input_dataset <\/code>","<code> input_dataset <\/code>"],["<code> input_id <\/code>","<code> input_var <\/code>","<code> input_var <\/code>","<code> input_var_x ; input_var_y <\/code>","<code> input_var <\/code>","<code> <b>__BLANK__<\/b> <\/code>","<code> <b>__BLANK__<\/b> <\/code>","<code> <b>impossible<\/b> <\/code>","<code> <b>undetermined<\/b> <\/code>"],["<code> <b>id_creation<\/b><em style=\"color:red\"> (mandatory)<\/em> <\/code>","<code> <b>direct_mapping<\/b> <\/code>","<code> <b>recode<\/b> <\/code>","<code> <b>case_when<\/b> <\/code>","<code> <b>operation<\/b> <\/code>","<code> <b>paste<\/b> <\/code>","<code> <b>other<\/b> <\/code>","<code> <b>impossible<\/b> <\/code>","<code> <b>undetermined<\/b> <\/code>"],["<code> <b>id_creation<\/b> <\/code>","<code> <b>direct_mapping<\/b> <\/code>","<code> <b>recode(<\/b>\n  \"YES\" = 1 ;\n  \"NO\"  = 0 ;\n  ELSE  = NA<b>) <\/b> <\/code>","<code> <b>case_when(<\/b>\n  var_x == 1 ~ var_z ;\n  ELSE       ~ NA<b>)<\/b> <\/code>","<code> <em># simple R code here such as :<\/em><\/b>\n  (<b>mean(<\/b>input_var<b>)<\/b> - input_var<b>)<\/b> / <b>stats::sd(<\/b>input_var<b>)<\/b> <\/code>","<code> \"Hello word\" <\/code>","<code> # place complex R code here... <\/code>","<code> <b>impossible<\/b> <\/code>","<code> <b>undetermined<\/b> <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th><b>dataschema_variable<\/b><\/th>\n      <th><b>input_dataset<\/b><\/th>\n      <th><b>input_variables<\/b><\/th>\n      <th><b>Mlstr_harmo::rule_category<\/b><\/th>\n      <th><b>Mlstr_harmo::algorithm<\/b><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"columnDefs":[{"className":"dt-head-left","targets":"_all"}],"headerCallback":"function(thead) { $(thead).css('font-size', '0.7em');}","paging":false,"info":false,"scrollX":true,"ordering":false,"pageLength":9,"dom":"Bfrtip","buttons":["copy","csv","excel"],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[9,10,25,50,100]}},"evals":["options.headerCallback"],"jsHooks":[]}</script>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Guillaume Fabre, Maelstrom-research.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
