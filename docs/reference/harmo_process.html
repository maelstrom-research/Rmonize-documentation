<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generate harmonized dataset(s) and annotated Data Processing Elements — harmo_process • Rmonize</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generate harmonized dataset(s) and annotated Data Processing Elements — harmo_process"><meta property="og:description" content="Reads the DataSchema and Data Processing Elements objects to generate
harmonized dataset(s) and annotated Data Processing Elements object with
harmonization statuses and any processing errors. The function uses
the DataSchema and Data Processing Elements specifications to process
input variables into output harmonized variables for each dataset.
Documentation of each data processing action is generated in the console to
support the identification of errors and correction of
the Data Processing Elements file and objects, as needed. An
annotated Data Processing Elements is also produced, providing harmonization
statuses (complete/impossible) for each DataSchema variable in input
dataset, which can be used to create a summary of the harmonization
potential of the DataSchema variables across input dataset(s)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rmonize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0.0000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/a-Glossary-and-templates.html">Glossary and templates</a>
    </li>
    <li>
      <a href="../articles/b-Understand-the-workflow.html">Understand the workflow</a>
    </li>
    <li>
      <a href="../articles/c-The-Data-processing-elements.html">The Data Processing Elements</a>
    </li>
    <li>
      <a href="../articles/d-Example-with-DEMO-files.html">Example with DEMO files</a>
    </li>
    <li>
      <a href="../articles/e-Get-Started.html">Get Started</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/maelstrom-research/Rmonize/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate harmonized dataset(s) and annotated Data Processing Elements</h1>
    <small class="dont-index">Source: <a href="https://github.com/maelstrom-research/Rmonize/blob/HEAD/R/02-harmo_process_harmonization.R" class="external-link"><code>R/02-harmo_process_harmonization.R</code></a></small>
    <div class="hidden name"><code>harmo_process.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Reads the DataSchema and Data Processing Elements objects to generate
harmonized dataset(s) and annotated Data Processing Elements object with
harmonization statuses and any processing errors. The function uses
the DataSchema and Data Processing Elements specifications to process
input variables into output harmonized variables for each dataset.
Documentation of each data processing action is generated in the console to
support the identification of errors and correction of
the Data Processing Elements file and objects, as needed. An
annotated Data Processing Elements is also produced, providing harmonization
statuses (complete/impossible) for each DataSchema variable in input
dataset, which can be used to create a summary of the harmonization
potential of the DataSchema variables across input dataset(s).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">harmo_process</span><span class="op">(</span><span class="va">dossier</span>, dataschema <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">data_proc_elem</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dossier</dt>
<dd><p>List of tibble(s), each of them being datasets to be
harmonised.</p></dd>


<dt>dataschema</dt>
<dd><p>A list of tibble(s) representing metadata of an
associated harmonized dossier.</p></dd>


<dt>data_proc_elem</dt>
<dd><p>A tibble, identifying the input
Data Processing Elements.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list of tibbles of each harmonized dataset that has been harmonized from
input datataset.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>A dossier must be a named list containing at least one data frame or
data frame extension (e.g. a tibble), each of them being datasets.
The name of each tibble will be use as the reference name of the dataset.</p>
<p>A DataSchema defines the harmonized variables to be generated, and also
represents metadata of an associated harmonized dossier. It must be a list
of data frame or data frame extension (e.g. a tibble) objects with elements
named "Variables" (required) and "Categories" (if any). The "Variables"
element must contain at least the <code>name</code> column, and the "Categories" element
must contain at least the <code>variable</code> and <code>name</code> columns to be usable in any
function. To be considered as a minimum workable DataSchema, in "Variables"
the <code>name</code> column must also have unique and non-null entries, and in
"Categories" the combination of <code>variable</code> and <code>name</code> columns must also be
unique.</p>
<p>A Data Processing Elements contains the rules and metadata that will be used
to perform harmonization of input datasets in accordance with the DataSchema.
It must be a data frame or data frame extension (e.g. a tibble) and it must
contain certain columns which participate to the process, including the
<code>dataschema_variable</code>, <code>input_dataset</code>,<code>input_variables</code>,
<code>Mlstr_harmo::rule_category</code> and  <code>Mlstr_harmo::algorithm</code>. The mandatory
first processing element must be "id_creation" in
<code>Mlstr_harmo::rule_category</code> followed by the name of the column taken as
identifier of each dataset to initiate the process of harmonization.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can use our demonstration files to run examples</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/maelstrom-research/madshapR" class="external-link">madshapR</a></span><span class="op">)</span> <span class="co"># data_dict_filter</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dataset_MELBOURNE_1</span> <span class="op">&lt;-</span> <span class="va">DEMO_files_harmo</span><span class="op">$</span><span class="va">dataset_MELBOURNE_1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">dossier</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/madshapR/man/dossier_create.html" class="external-link">dossier_create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dataset_MELBOURNE_1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dataschema</span> <span class="op">&lt;-</span> </span></span>
<span class="r-in"><span>  <span class="va">DEMO_files_harmo</span><span class="op">$</span><span class="va">`dataschema - final`</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/madshapR/man/data_dict_filter.html" class="external-link">data_dict_filter</a></span><span class="op">(</span><span class="st">'name == "adm_unique_id"'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">data_proc_elem</span> <span class="op">&lt;-</span> <span class="va">DEMO_files_harmo</span><span class="op">$</span><span class="va">`data_processing_elements - final`</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dataschema_variable</span> <span class="op">==</span> <span class="st">'adm_unique_id'</span>,</span></span>
<span class="r-in"><span>         <span class="va">input_dataset</span> <span class="op">==</span> <span class="st">'dataset_MELBOURNE_1'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># perform harmonization</span></span></span>
<span class="r-in"><span><span class="fu">harmo_process</span><span class="op">(</span><span class="va">dossier</span>,<span class="va">dataschema</span>,<span class="va">data_proc_elem</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">- Data Processing Elements: ------------------------------------------------</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> --harmonization of : <span style="font-weight: bold;">dataset_MELBOURNE_1</span> ------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     processing 1/1 : adm_unique_id                <span style="font-weight: bold;">id created</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> - CREATION OF HARMONIZED DATA DICTIONARY : --------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">dataset_MELBOURNE_1</span> : done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your harmonization is done. Please check if everything worked correctly.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">- WARNING MESSAGES (if any): ----------------------------------------------</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dataset_MELBOURNE_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 19 × 1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    adm_unique_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 377943       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 497013       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 927676       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 995667       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 21829        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 209432       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 272983       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 580632       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 304624       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 637551       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> 279817       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> 235415       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> 373673       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> 485098       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> 299427       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> 854073       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> 197666       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> 130327       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> 220050       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Rmonize::class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "harmonized_dossier"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Rmonize::DataSchema")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Rmonize::DataSchema")$Variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   name          `label:en`  valueType index `Mlstr_area::1` `Mlstr_area::1.term`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> adm_unique_id Unique ide… text      1     ADM             Identifiers         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Rmonize::DataSchema")attr(,"madshapR::class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "data_dict_mlstr"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Rmonize::DataSchema")attr(,"Rmonize::class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dataSchema_mlstr"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Rmonize::Data Processing Elements")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   index dataschema_variable valueType input_dataset       input_variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 adm_unique_id       text      dataset_MELBOURNE_1 id             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 6 more variables: `Mlstr_harmo::rule_category` &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   `Mlstr_harmo::algorithm` &lt;chr&gt;, `Mlstr_harmo::status` &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   `Mlstr_harmo::status_detail` &lt;chr&gt;, `Mlstr_harmo::comment` &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   `Rmonize::r_script` &lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Rmonize::harmonized_col_id")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "adm_unique_id"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Guillaume Fabre, Maelstrom-research group.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

